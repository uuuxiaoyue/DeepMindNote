<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.web.WebView?>
<?import javafx.geometry.Insets?>
<VBox fx:id="rootContainer" prefHeight="700.0" prefWidth="1100.0"
      xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.deepmind.controller.MainController"
      stylesheets="@../css/style.css">

    <HBox styleClass="top-bar" spacing="10" alignment="CENTER_LEFT">

        <ToggleButton fx:id="btnToggleSidebar" text="â—°" styleClass="icon-button"
                      onAction="#handleToggleSidebar" selected="true">
            <tooltip><Tooltip text="æ˜¾ç¤º/éšè—ä¾§è¾¹æ "/></tooltip>
        </ToggleButton>

        <Separator orientation="VERTICAL" />

        <MenuBar fx:id="mainMenuBar" styleClass="menu-bar" style="-fx-background-color: transparent;">
            <menus>
                <Menu text="æ–‡ä»¶(F)">
                    <items>
                        <MenuItem text="æ–°å»º" accelerator="Ctrl+N" onAction="#handleNewNote"/>
                        <MenuItem text="æ–°å»ºçª—å£" accelerator="Ctrl+Shift+N"/>
                        <SeparatorMenuItem />
                        <MenuItem text="æ‰“å¼€..." accelerator="Ctrl+O"/>
                        <MenuItem text="æ‰“å¼€æ–‡ä»¶å¤¹..."/>
                        <SeparatorMenuItem />
                        <MenuItem text="å¿«é€Ÿæ‰“å¼€..." accelerator="Ctrl+P"/>
                        <Menu text="æ‰“å¼€æœ€è¿‘æ–‡ä»¶"/>
                        <SeparatorMenuItem />
                        <MenuItem text="ä¿å­˜" accelerator="Ctrl+S" onAction="#handleSave"/>
                        <MenuItem text="å¦å­˜ä¸º..." accelerator="Ctrl+Shift+S"/>
                        <MenuItem text="ä¿å­˜å…¨éƒ¨æ‰“å¼€çš„æ–‡ä»¶..."/>
                        <SeparatorMenuItem />
                        <MenuItem text="å±žæ€§..."/>
                        <MenuItem text="æ‰“å¼€æ–‡ä»¶ä½ç½®..."/>
                        <MenuItem text="åœ¨ä¾§è¾¹æ ä¸­æ˜¾ç¤º"/>
                        <MenuItem text="åˆ é™¤..."/>
                        <SeparatorMenuItem />
                        <MenuItem text="å¯¼å…¥..." accelerator="Ctrl+I" onAction="#handleImport"/>
                        <Menu text="å¯¼å‡º">
                            <items>
                                <MenuItem text="Markdown (.md)" onAction="#handleExportMarkdown" />
                                <MenuItem text="PDF æ–‡æ¡£ (.pdf)" onAction="#handleExportPDF" />
                                <MenuItem text="Word æ–‡æ¡£ (.docx)" onAction="#handleExportWord" />
                                <SeparatorMenuItem />
                                <MenuItem text="ç½‘é¡µ (å¸¦æ ·å¼ .html)" onAction="#handleExportHTMLFull" />
                                <MenuItem text="ç½‘é¡µ (çº¯å‡€ç‰ˆ .html)" onAction="#handleExportHTMLRaw" />
                                <SeparatorMenuItem />
                                <MenuItem text="é•¿å›¾åˆ†äº« (.png)" onAction="#handleExportImage" />
                            </items>
                        </Menu>                        <MenuItem text="æ‰“å°..." accelerator="Alt+Shift+P"/>
                        <SeparatorMenuItem />
                        <MenuItem text="åå¥½è®¾ç½®..." accelerator="Ctrl+,"/>
                        <SeparatorMenuItem />
                        <MenuItem text="å…³é—­" accelerator="Ctrl+W"/>
                    </items>
                </Menu>

                <Menu text="ç¼–è¾‘(E)">
                    <items>
                        <MenuItem text="æ’¤é”€" accelerator="Ctrl+Z"/>
                        <MenuItem text="é‡åš" accelerator="Ctrl+Y"/>
                        <SeparatorMenuItem />
                        <MenuItem text="å‰ªåˆ‡" accelerator="Ctrl+X"/>
                        <MenuItem text="å¤åˆ¶" accelerator="Ctrl+C"/>
                        <MenuItem text="ç²˜è´´" accelerator="Ctrl+V"/>
                        <SeparatorMenuItem />
                        <MenuItem text="æŸ¥æ‰¾" accelerator="Ctrl+F"/>
                        <MenuItem text="æ›¿æ¢" accelerator="Ctrl+H"/>
                    </items>
                </Menu>

                <Menu text="æ®µè½(P)">
                    <items><MenuItem text="æ ‡é¢˜1"/><MenuItem text="æ ‡é¢˜2"/></items>
                </Menu>
                <Menu text="æ ¼å¼(O)">
                    <items><MenuItem text="åŠ ç²—"/><MenuItem text="æ–œä½“"/></items>
                </Menu>
                <Menu text="è§†å›¾(V)">
                    <items>
                        <MenuItem text="æºä»£ç æ¨¡å¼" onAction="#handleEditMode"/>
                        <MenuItem text="é¢„è§ˆæ¨¡å¼" onAction="#handlePreviewMode"/>
                        <SeparatorMenuItem />
                        <MenuItem text="æ˜¾ç¤º/éšè—ä¾§è¾¹æ " onAction="#handleToggleSidebar"/>
                        <MenuItem text="æ˜¾ç¤º/éšè—å¤§çº²" onAction="#toggleOutline"/>
                    </items>
                </Menu>
                <Menu text="ä¸»é¢˜(T)">
                    <items>
                        <RadioMenuItem text="é»˜è®¤è“" onAction="#handleThemeMenuAction" selected="true">
                            <toggleGroup><ToggleGroup fx:id="themeGroup"/></toggleGroup>
                        </RadioMenuItem>
                        <RadioMenuItem text="æš—å¤œé»‘" onAction="#handleThemeMenuAction" toggleGroup="$themeGroup"/>
                        <RadioMenuItem text="æ£®ç³»ç»¿" onAction="#handleThemeMenuAction" toggleGroup="$themeGroup"/>
                        <RadioMenuItem text="æš–é˜³æ©™" onAction="#handleThemeMenuAction" toggleGroup="$themeGroup"/>
                    </items>
                </Menu>
                <Menu text="å¸®åŠ©(H)">
                    <items><MenuItem text="å…³äºŽ"/></items>
                </Menu>
            </menus>
        </MenuBar>

    </HBox>


    <SplitPane fx:id="splitPane" dividerPositions="0.2, 0.8" VBox.vgrow="ALWAYS" style="-fx-background-color: -color-bg-base;">
        <items>
            <VBox fx:id="sidebarContainer" minWidth="0" maxWidth="400" spacing="10" styleClass="sidebar">
                <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>

                <HBox alignment="CENTER_RIGHT" spacing="5">
                    <Region HBox.hgrow="ALWAYS" />

                    <Button onAction="#handleNewNote" styleClass="icon-btn-small">
                        <tooltip><Tooltip text="æ–°å»ºç¬”è®°"/></tooltip>
                        <graphic>
                            <javafx.scene.shape.SVGPath content="M14 4a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h10zm0 2H4v12h10V6z M11 8l-4 4 4 4" fill="#6c757d" scaleX="0.8" scaleY="0.8"/>
                            <javafx.scene.shape.SVGPath content="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" fill="#6c757d" scaleX="0.7" scaleY="0.7"/>
                        </graphic>
                    </Button>

                    <Button onAction="#handleNewFolder" styleClass="icon-btn-small">
                        <tooltip><Tooltip text="æ–°å»ºåˆ†ç±»æ–‡ä»¶å¤¹"/></tooltip>
                        <graphic>
                            <javafx.scene.shape.SVGPath content="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z M15 14h-2v2h-2v-2H9v-2h2v-2h2v2h2v2z" fill="#6c757d" scaleX="0.7" scaleY="0.7"/>
                        </graphic>
                    </Button>
                </HBox>

                <TextField fx:id="searchField" promptText="ðŸ” æœç´¢ç¬”è®°..." />

                <TreeView fx:id="fileTree" VBox.vgrow="ALWAYS" showRoot="false"/>
            </VBox>

            <VBox spacing="10" style="-fx-background-color: -color-bg-base;">
                <StackPane VBox.vgrow="ALWAYS">
                    <TextArea fx:id="editorArea" wrapText="true" />
                    <WebView fx:id="webView" visible="false" />
                </StackPane>

                <HBox alignment="CENTER_LEFT" spacing="10" styleClass="status-bar">
                    <Label fx:id="wordCountLabel" text="å­—æ•°: 0" styleClass="text-muted" />

                    <Region HBox.hgrow="ALWAYS" />

                    <Button onAction="#handleEditMode" styleClass="status-btn" text="&lt;/&gt;">
                        <tooltip><Tooltip text="å¯ç”¨æºä»£ç æ¨¡å¼"/></tooltip>
                    </Button>

                    <Button onAction="#toggleOutline" styleClass="status-btn" text="â—‹">
                        <tooltip><Tooltip text="å±•å¼€/å…³é—­å¤§çº²æ "/></tooltip>
                    </Button>


                </HBox>
            </VBox>

            <VBox fx:id="outlineContainer" minWidth="0" maxWidth="250" spacing="10" styleClass="sidebar">
                <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>
                <Label text="æ–‡ç« å¤§çº²" style="-fx-font-weight:bold"/>
                <ListView fx:id="outlineListView" VBox.vgrow="ALWAYS" />
            </VBox>
        </items>
    </SplitPane>

</VBox>